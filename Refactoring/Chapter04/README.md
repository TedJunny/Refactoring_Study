# 테스트 구축

견고한 테스트 스위트가 뒷받침되어야 리팩토링도 잘 된다.

리팩토링이 잘 되었는지 테스트 스위트로 검증을 꼭 하자

## 자가 테스트 코드의 가치

실제로 코드 짜는데 시간을 확인해보면 그렇게 오래 걸리진 않는다.

현재 상황을 파악하거나 설계를 고민하기도 한다.

물론 대부분의 시간은 디버깅에 쓸것

버그 수정은 금방 끝나지만 버그를 찾는게 생각보다 오래 걸린다.

### 습관 들이기

테스트 스위트 작성 -> 테스트 자동화 -> 실행시 테스트 먼저 동작 후 실행

하나 작성해두고 자주 수행하는 습관 들일것

새로운 기능을 추가할때마다 테스트를 추가하다보면 리팩토링을 했을때 회귀 버그를 빠르게 캐치할 수 있따.

### 테스트는 언제?

프로그램이 시작 전이 가장 좋다. 기능을 추가하기 전 미리 테스트부터 작성할 것

장점

- 원하는 기능을 추가하기 위해 무엇이 필요한지 더욱 고민하게 됨
- 구현보다 인터페이스에 집중하게 된다
- 코딩이 완료되는 시점을 정확하게 판단 가능
- > 이게 바로 TDD

## 자바스크립트에서 테스트

예시 : 사용자가 생산 계획을 검토하고 수정하도록 해주는 애플리케이션을 테스트

생산 계획

- 지역
    - 생산자
        - 비용
        - 생산량
        - 수익
    - 부족분
    - 총수익
- 수요
- 가격

모카를 설치해서 예시 코드 테스트를 해보자.

사용법은 직접 사용해보면서 익혀야한다.

테스트를 할떄는 오류 케이스도 작성할 필요가 있다.

```
// error case
get shortfall() {
  return this.demand - this.totalProduction * 2;
}

```

모카 말고도 chai란것도 있고 jest도 있고 엄청 많다

입맛에 맞는 테스트 라이브러리를 찾아내거나 회사의 경우 하나를 정하여 쓰자.

## 픽스처 수정

픽스처(fixture) : 테스트에 필요한 데이터와 객체

```
it('change production', function() {
  asia.producers[0].production = 20;
  assert.equal(asia.shortfall, -6);
  assert.equal(asia.profit, 292);
})

```

위와 같이 픽스처 수정이 포함된 테스트가 일반적

### 테스트 단계 여러가지 이름

- 설정-실행-검증 (setup-exercise-verify)
- 조건-발생-결과 (given-when-then)
- 준비-수행-단언 (arrange-act-assert)

해체(teardown) 또는 청소(cleanup) 이라고 하는 네번째 단계도 있으나 실무에서 사용되지 않음

픽스처를 수정했을때 연관된 데이터를 모두 테스트

## 경계 조건 검사

여러가지 예외 사항에 맞춰서 테스트를 하자.

값이 없을때나 올바른 값이 아닐때 어떤 값이 나와야 하는지 확인하자

내가 작성한 코드를 적이라 생각하고 공격을 하듯이 테스트하자

### string for producers

이 테스트의 경우 예상했던 메세지는 0이 아니다 라는 메세지여야 하는데 실제로는 에러 메세지가 나온다.

이 경우는 어떻게 해야할까?

그리고 어느 수준까지 테스트를 해야 하는가?

## 마지막

여기서 했던 테스트는 단위 테스트에 해당된다.

코드의 작은 영역만을 대상으로 빠르게 실행되도록 설계된 테스트며 자바 테스트 코드의 핵심이다.

이외에도 다양한 테스트가 있다.

- 컴포넌트 사이의 상호작용에 집중하는 테스트
- 소프트웨어의 다양한 계층의 연동을 검사하는 테스트
- 성능 문제를 다루는 테스트
- 기타 등등
- [참고](https://dlwjdcks5343.tistory.com/193)

한 번에 완벽한 테스트 스위트를 작성할 순 없기 때문에 지속적으로 보강해주어야 한다.

기능을 추가하거나 디펙리스트에 버그가 올라오면 그에 대한 테스트를 작성하자.

테스트 스위트가 충분한지를 평가하는 기준은 주관적이기 때문에 본인이 만족이 안되면 계속 하자.

## 우리는 어떻게

### 프론트

- [스토리북](https://storybook.js.org/blog/structuring-your-storybook/)
    - 상태값에 따라 컴포넌트가 올바르게 표현이 되는지 확인
    - 디자인 가이드가 됨
    - 디자인 툴이랑 연동도 가능
- [Selenium Webdriver](https://www.netguru.com/blog/which-javascript-ui-testing-framework-to-use-in-2020)
    - 코드로 브라우저를 컨트롤
    - 로그인을 하여 원하는 액션을 했을때 제대로된 결과가 나오는지 코드로 확인 가능
- [Cypress](https://velog.io/@_woogie/E2E%ED%85%8C%EC%8A%A4%ED%8A%B8-with-Cypress)
    - 익숙한 방식으로 테스트 코드 작성
    - 화면도 제공

### 백엔드

jest를 써서 API 테스트를 진행중

자세한 설명은 백엔드분들이...